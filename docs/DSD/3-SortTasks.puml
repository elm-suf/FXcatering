@startuml
skinparam defaultTextAlignment center
skinparam SequenceMessageAlign center

title sort Tasks
Actor Chef as ch
participant "AppM.eventManager:\nEventManager" as EventManager
participant "AppM.userManager:\nUserManager" as UserManager


ch ->  EventManager: sortTask(task: Task, index: int)
activate EventManager
  EventManager -> UserManager: getCurrentUser()
  activate UserManager
      UserManager --> EventManager: user
  deactivate UserManager

   alt !user.isChef()
          ch <--x EventManager: UseCaseLogicException
       else
           participant "AppM.eventManager.\ncurrentEvent.tasks:\n List<Task>" as task
           EventManager -> task: remove(task)
           activate task
           EventManager -> task: add(task, index)
           deactivate task

       loop for r in receivers
           participant "receiver:\n CATEventReceiver" as r
          EventManager -> r : notifyTaskSorted(task)
          activate r
          deactivate r
       end
   end
deactivate EventManager

@enduml
